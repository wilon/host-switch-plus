chrome.extension.onRequest.addListener(function(request,sender,sendResponse){function updateDivDom(divDom){var ip=divDom.innerHTML,intervalCtrl1,intervalCtrl2,updateDom=function(){clearInterval(intervalCtrl2);var stockConfig=["sh000001","sh600720","sh601003","sh600368","sh600008","sz000903","sz002024","sz002624","sh600939","sh601633"],stockInfo=[];chrome.extension.sendMessage({ip:ip,stock:stockConfig},function(response){var date=new Date,w=date.getDay(),h=date.getHours(),m=date.getMinutes(),notWorkWeek=0==w||6==w,notWorkHour=h<9||h>14||12==h,notWork11Hour=11==h&&m>30,notWork=notWorkWeek||notWorkHour||notWork11Hour;if(notWork)return clearInterval(intervalCtrl1),divDom.innerHTML=ip+" "+response.location,document.body.appendChild(divDom);eval(response.stock.content),stockConfig.map(function(elem){var hqStr="hq_str_"+elem;eval("var info = "+hqStr+'.split(",")'),stockInfo.push({name:info[0],code:elem,openPrice:info[2],currPrice:info[3]})});var changeDom=function(){var dd=parseInt(Math.random()*stockInfo.length),stock=stockInfo[dd],bai=(stock.currPrice-stock.openPrice)/stock.openPrice*100,updown=bai>0?"▲":"▼";divDom.innerHTML=ip+" "+response.location+"<br>"+stock.name+" "+parseFloat(stock.currPrice).toFixed(2)+" "+updown+" "+parseFloat(bai).toFixed(2)+"%",document.body.appendChild(divDom)};changeDom(),intervalCtrl2=setInterval(changeDom,5e3)})};updateDom(),intervalCtrl1=setInterval(updateDom,15e3)}var style='display: block;position: fixed;bottom: 3px;color: rgb(51, 51, 51);cursor: default;vertical-align: baseline;user-select: none;z-index: 2147483646;opacity: 1;background: rgb(217, 234, 211) !important;padding: 4px 5px !important;border-width: 1px !important;border-style: solid !important;border-color: rgb(145, 145, 145) !important;border-image: initial !important;font: 12px/1.1 "Microsoft YaHei", Arial, Helvetica, sans-serif !important;outline: 0px !important;margin: 0px !important;right:10px;',divDom=document.createElement("div");divDom.id="snail-hosts-ipview",divDom.style.cssText='display: block;position: fixed;bottom: 3px;color: rgb(51, 51, 51);cursor: default;vertical-align: baseline;user-select: none;z-index: 2147483646;opacity: 1;background: rgb(217, 234, 211) !important;padding: 4px 5px !important;border-width: 1px !important;border-style: solid !important;border-color: rgb(145, 145, 145) !important;border-image: initial !important;font: 12px/1.1 "Microsoft YaHei", Arial, Helvetica, sans-serif !important;outline: 0px !important;margin: 0px !important;right:10px;',divDom.innerHTML=request.ip,updateDivDom(divDom),divDom.onmouseover=function(){var ipView=document.getElementById("snail-hosts-ipview");"10px"!==ipView.style.top?(ipView.style.top="10px",ipView.style.bottom=""):(ipView.style.bottom="3px",ipView.style.top="")},sendResponse({})});